#!/usr/bin/expect -f

set timeout -1

spawn /bin/sh

set executable  [lindex $argv 0];
set output_path [lindex $argv 1];
set contents    [lindex $argv 2];

expect "sh"
send -- "$executable \$(tty) $output_path\r"
expect "$executable"
send -- "$contents\x04\x04"
expect "sh"
send -- "exit\r"

expect eof
